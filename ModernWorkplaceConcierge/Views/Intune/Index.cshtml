@{
    ViewBag.Current = "IntuneExport";
}

    <div class="jumbotron">
        <h1>Export Intune configuration and settings</h1>

        <p>Items in export will be included in JSON format within a ZIP file.</p>

        @using (Html.BeginForm("DownloadAsync", "IntuneConfigExport", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
                <input type="text" name="clientId" class="d-none" id="clientId">
                
                <button class="btn btn-primary btn-large" type="submit" id="upload">
                    <i class="far fa-file-archive"></i>
                    <span>Export Intune configuration</span>
                </button>
        }
    </div>

@section scripts {
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/Scripts/jquery.signalR-2.4.1.min.js"></script>
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->

    <script type="text/javascript">
        $(function () {
            //Proxy created on the fly
            var chat = $.connection.mwHub;

            $.connection.hub.logging = true;

             $.connection.hub.start().done(function () {
                chat.server.sendMessage("SignalR connection established, connection ID: " + $.connection.hub.id);
                var input = document.getElementById('clientId');
                input.value = $.connection.hub.id;
             });

            chat.client.AddMessage = function (message) {
                $("#messages").prepend("<li class=\"list-group-item\"><small>" + (new Date().toISOString().toString()) + " " + message + "</small></li>");
            };
        });
    </script>
}